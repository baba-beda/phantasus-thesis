morpheus.js
-----------
Как уже было рассказано в обзоре, morpheus.js --- веб-приложение, полностью созданное на JavaScript, для визуализации и анализа матриц.

В этом разделе будут описаны основные классы и функции, реализованные в исходном коде morpheus.js, которые будут в дальнейшем необходимы для расширения функционала.

### Чтение данных ###

В morpheus.js данные могут быть загружены из файла, полученного одним из следующих путей:

* Из компьютера;
* По URL-ссылке;
* Из Dropbox.

Допустимые форматы загружаемых файлов:

* txt-файл с tab-разделителями;
* Excel-таблица;
* MAF [@maf];
* GCT [@gct];
* GMT [@gmt].

Для каждого формата файла в исходном коде morpheus.js присутствует соответствующий обработчик данных.

Также, morpheus.js предлагает набор предзагруженных данных из базы TCGA [@tcga].

### Класс Dataset ###

Одним из ключевых классов всего веб-приложения является класс Dataset. В каждом экземпляре этого класса хранится вся необходимая информация о данных, в которую входят:

* Числовая матрица, характеризующая уровень экспрессии всех генов во всех образцах;
* Количество строк и столбцов в матрице;
* Аннотация к образцам, например:
    * пол, возраст, контактную информацию испытуемых, если образцы были взяты с людей;
    * есть или нет инфекция в данном образце;
    * способ лечения;
    * контакты ответственного за взятие данного образца и пр.;
* Аннотация к генам, например:
    * Идентификатор гена в том или ином стандарте;
    * Числовые характеристики гена (средний уровень экспрессии по образцам, номер кластера) и пр.

Аннотация реализована в классе _MetadataModel_, который представляет собой не что иное, как набор именованных векторов с характеристиками. В каждом векторе хранятся:

* Название;
* Формат (строка, число);
* Массив значений.

Для векторов так же предусмотрены утилиты для визуализации. Так, например, есть возможность показать аннотацию в виде текста и/или цветом, что удобно для категориальных характеристик. 

### Класс SlicedDatasetView ###

Чаще всего во время работы программы экземпляры класса Dataset становятся обернуты в оболочку из SlicedDatasetView. Этот дополнительный класс дает возможность не пересоздавать каждый раз Dataset, а просто добавляет к данным информацию о том, какие индексы строк и столбцов выбраны и используются в данный момент.

### Класс HeatMap ###

Данный класс предназначен для визуализации данных, обернутых в класс Dataset или SlicedDatasetView. Он дает возможность выбирать, какая аннотация будет представлена на экране, цветовой код, выбирать строки и столбцы, с которыми будут работать те или иные инструменты.

### Реализованные методы исследования и обработки данных ###

В morpheus.js имеются реализации следующих методов:

* Adjust --- инструмент для корректировки данных:
    * $\log_{2}$;
    * $\log_{2}^{-1}$;
    * Квантиль-нормализация;
    * Z-тест;
    * Устойчивый Z-тест.
* Collapse --- инструмент, позволяющий агрегировать строки или столбцы с одинаковыми значениями с помощью функции: min, max, mean, median, sum, maximum of 25 and 75 percentiles;
* Создать вычисленную аннотацию для строк или столбцов;
* Similarity Matrix;
* Transpose;
* t-SNE;
* Построение графиков.

Также присутствуют фильтрация и сортировка. 